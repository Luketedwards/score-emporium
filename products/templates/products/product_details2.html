{% extends "base.html" %}
{% load static %}
{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/checkout.css' %}">
<link rel="stylesheet" href="{% static  'css/dashboard.css' %}">
{% endblock %}



{% block content %}

<div class="dashboard-main-wrapper">

    <div class="dashboard-wrapper">
        <div class="dashboard-ecommerce">
            <div class="container-fluid dashboard-content ">

                <div class="row">
                    <div class="center col-xl-8 col-lg-12 col-md-12 col-sm-12 col-12">
                        <div class="row">
                            <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12 pr-xl-0 pr-lg-0 pr-md-0  m-b-30">
                                <div class="product-slider">
                                    <img id="product-detail-img" class="card-img-top img-fluid shadow-checkout"
                                        src="{{MEDIA_URL}}{{product.image}}" alt="">
                                </div>
                            </div>
                            <div
                                class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12 pl-xl-0 pl-lg-0 pl-md-0 border-left m-b-30">
                                <div class="product-details">
                                    <div class="border-bottom pb-3 mb-3">
                                        <h2 class="mb-3">{{product.name|title}}</h2>
                                        <div class="product-rating d-inline-block float-right">
                                            {% if product.rating %}
                                            <span class="text-muted gold"><i
                                                    class="fas fa-star mr-1"></i>{{ product.rating }} / 5</span>
                                            {% else %}
                                            <span class="text-muted">No Rating</span>
                                            {% endif %}

                                        </div>
                                        <h3 class="mb-0 text-primary">£{{product.price}}</h3>
                                    </div>
                                    <div class="product-colors border-bottom">
                                        <h4>Details</h4>
                                        <p>Genre: {%if product.genre%}{{product.genre}}{%else%}n/a{%endif%}</p>
                                        <p>Difficulty:
                                            {%if product.difficulty%}{{product.difficulty}}{%else%}n/a{%endif%}</p>

                                    </div>

                                    <div class="product-description">
                                        <h4 class="mb-1">Description</h4>
                                        <p>{{product.description|capfirst}}</p>
                                        <hr>
                                        <form class="form" action="{% url 'add_to_cart' product.id %}" method="POST">
                                            {% csrf_token %}
                                            <div class="form-row">

                                                <div class="col{% if s %}-12 mt-2{% endif %} text-center">
                                                    {% if not request.user.is_authenticated %}
                                                    <a id="product-btn" href="{% url 'account_login' %}"
                                                        class="btn btn-black product-btn mt-5">Login to Add to Cart</a>
                                                    {% else %}


                                                    {% if not request.session.cart and product.id not in ordersList%}
                                                    <input id="product-btn" type="submit"
                                                        class="btn btn-black product-btn mt-5" value="Add to cart">
                                                    {%else%}
                                                    {% if product.id in ordersList%}
                                                    <input style="width: 5rem;" id="product-btn" disabled type=""
                                                        class="btn btn-black product-btn mt-5" value="Owned">

                                                    {% elif product.id|stringformat:"i" not in request.session.cart %}
                                                    <input id="product-btn" type="submit"
                                                        class="btn btn-black product-btn mt-5" value="Add to cart">
                                                    {% else %}
                                                    <input style="width: 5rem;" id="product-btn" disabled type=""
                                                        class="btn btn-black product-btn mt-5" value="Added">

                                                    {%endif%}
                                                    {%endif%}
                                                    {% endif %}
                                                    <a href="{% url 'products' %}"
                                                        class="btn animated-btn btn-primary  mt-5">

                                                        <span class="">Keep Shopping</span>
                                                    </a>

                                                </div>
                                                <input type="hidden" name="redirect_url" value="{{ request.path }}">

                                            </div>


                                        </form>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 m-b-60">
                                <div class="simple-card">
                                    <ul class="nav nav-tabs" id="myTab5" role="tablist">
                                        <li class="nav-item">
                                            <a class="nav-link active border-left-0 text-center" id="product-tab-1"
                                                data-toggle="tab" href="#tab-1" role="tab" aria-controls="product-tab-1"
                                                aria-selected="true">Description</a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link text-center" id="product-tab-2" data-toggle="tab"
                                                href="#tab-2" role="tab" aria-controls="product-tab-2"
                                                aria-selected="false">Reviews</a>
                                        </li>
                                        {% if product.video%}
                                        <li class="nav-item">
                                            
                                            <a class="nav-link text-center" id="product-tab-3" data-toggle="tab"
                                                href="#tab-3" role="tab" aria-controls="product-tab-3"
                                                aria-selected="false">Video</a>
                                        </li>
                                        {%else%}
                                        <li class="nav-item btn-link disabled" >
                                            
                                            <a class="nav-link text-center text-danger" id="product-tab-3" data-toggle="tab"
                                                href="#" role="tab" aria-controls="product-tab-3"
                                                aria-selected="false">Video</a>
                                        </li>
                                        {%endif%}
                                        <li class="nav-item">
                                            <a class="nav-link text-center" id="product-tab-4" data-toggle="tab"
                                                href="#tab-4" role="tab" aria-controls="product-tab-4"
                                                aria-selected="false">Leave a Review</a>
                                        </li>
                                    </ul>
                                    <div class="tab-content" id="myTabContent5">


                                        <div class="tab-pane fade show active" id="tab-1" role="tabpanel"
                                            aria-labelledby="product-tab-1">
                                            <p>{{product.description|capfirst}}</p>

                                        </div>
                                        <div style="display: none;" class="tab-pane fade" id="tab-2" role="tabpanel"
                                            aria-labelledby="product-tab-2">
                                            {% include '../includes/overall_ratings.html' %}


                                        </div>
                                        <div style="display: none; background-color: white;position: relative;
                                        top: -3px;" class="tab-pane fade tab-content col-12 center p-3" id="tab-3"
                                            role="tabpanel" aria-labelledby="product-tab-3">
                                            <p>
                                                <iframe width="560" height="315" class="responsive-youtube d-flex "
                                                    src="{{product.video}}" frameborder="0"
                                                    allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"
                                                    allowfullscreen></iframe>
                                            </p>


                                        </div>
                                        <div style="display: none;" class="tab-pane fade tab-content" id="tab-4"
                                            role="tabpanel" aria-labelledby="product-tab-4">
                                            <p>
                                                {% include '../includes/leave_review.html' %}
                                            </p>


                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>


                    </div>
                    <div class="row mb-5">

                        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12 center">
                            <div class="card center">
                                <h5 class="card-header text-center">{{product.vendor|title}}'s Other Products</h5>
                                <div class="card-body center">
                                    <div id="carouselExampleIndicators1" class="carousel slide" data-ride="carousel">
                                        <ol class="carousel-indicators">
                                            {% for no_of_products in relevant_products%}


                                            <li style="background-color: black;" id="data-target{{forloop.counter0}}"
                                                data-target="#carouselExampleIndicators"
                                                data-slide-to="{{forloop.counter0}}" class=""></li>

                                            {%endfor%}

                                        </ol>
                                        <div class="carousel-inner center shadow-checkout" >
                                            {% for vendor_products in relevant_products%}
                                            <div id="carousel-item{{forloop.counter0}}" class="carousel-item ">
                                                {% if vendor_products.image %}
                                                <img style="height: 400px; margin: 0 auto !important; background-size: contain;" class="center"
                                                    src="{{MEDIA_URL}}{{vendor_products.image }}" data-color="lightblue"
                                                    alt="{{vendor_products.name}}">
                                                {% else %}
                                                <img style="height: 400px; width: 310px;" class=""
                                                    src="/media/No_Image_Available.jpg" data-color="lightblue"
                                                    alt="{{vendor_products.name}}">
                                                {%endif%}
                                                <div class="carousel-caption d-md-block">
                                                    <a href="{% url 'product_detail' vendor_products.id %}">
                                                        <h5 class="black-text translucent">{{vendor_products.name}}</h5>
                                                    </a>
                                                    <p class="lead mb-0 text-black font-weight-bold">
                                                        £{{ product.price }}</p>

                                                </div>
                                            </div>

                                            {% endfor %}

                                        </div>

                                    </div>
                                    <!-- Controls -->
                                    <a style="background-color: black; opacity: 0.6;left: 2rem;
                                    top: 3rem;
                                    height: 90%;
                                    width: 3rem;" class="carousel-control-prev" href="#carouselExampleIndicators1"
                                        role="button" data-slide="prev">
                                        <span style="background-color: black;" class="carousel-control-prev-icon"
                                            aria-hidden="true"></span>
                                        <span class="sr-only">Previous</span> </a>
                                    <a style="background-color: black; opacity: 0.6; right: 2rem;
                                      top: 3rem;
                                      height: 90%;
                                      width: 3rem;" class="carousel-control-next" href="#carouselExampleIndicators1"
                                        role="button" data-slide="next">
                                        <span style="background-color: black; " class="carousel-control-next-icon"
                                            aria-hidden="true"></span>
                                        <span class="sr-only">Next</span> </a>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

        </div>
        <!-- ============================================================== -->
        <!-- end wrapper  -->
        <!-- ============================================================== -->
    </div>

</div>
<!-- ============================================================== -->
<!-- end main wrapper  -->
<!-- ============================================================== -->
<!-- Optional JavaScript -->
<!-- jquery 3.3.1 -->
<script src="assets/vendor/jquery/jquery-3.3.1.min.js"></script>
<!-- bootstap bundle js -->
<script src="assets/vendor/bootstrap/js/bootstrap.bundle.js"></script>
<!-- slimscroll js -->
<script src="assets/vendor/slimscroll/jquery.slimscroll.js"></script>
<!-- main js -->
<script src="assets/libs/js/main-js.js"></script>
<script>
    jQuery(
            '<div class="quantity-nav"><div class="quantity-button quantity-up">+</div><div class="quantity-button quantity-down">-</div></div>'
        )
        .insertAfter('.quantity input');
    jQuery('.quantity').each(function () {
        var spinner = jQuery(this),
            input = spinner.find('input[type="number"]'),
            btnUp = spinner.find('.quantity-up'),
            btnDown = spinner.find('.quantity-down'),
            min = input.attr('min'),
            max = input.attr('max');

        btnUp.click(function () {
            var oldValue = parseFloat(input.val());
            if (oldValue >= max) {
                var newVal = oldValue;
            } else {
                var newVal = oldValue + 1;
            }
            spinner.find("input").val(newVal);
            spinner.find("input").trigger("change");
        });

        btnDown.click(function () {
            var oldValue = parseFloat(input.val());
            if (oldValue <= min) {
                var newVal = oldValue;
            } else {
                var newVal = oldValue - 1;
            }
            spinner.find("input").val(newVal);
            spinner.find("input").trigger("change");
        });

    });
</script>
{% endblock %}